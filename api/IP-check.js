if ($response.statusCode != 200) {
    $done(null);
}

const emojis = [
    "ğŸ†˜",
    "ğŸˆ²",
    "âš ï¸",
    "ğŸ”",
    "ğŸ“µ",
    "ğŸš¦",
    "ğŸ–",
    "ğŸ–¥",
    "ğŸ“º",
    "ğŸ§",
    "ğŸ¬",
    "ğŸ¦‰",
    "ğŸ„",
    "â›³ï¸",
    "ğŸš´",
    "ğŸ¤‘",
    "ğŸ‘½",
    "ğŸ¤–",
    "ğŸƒ",
    "ğŸ‘º",
    "ğŸ‘",
    "ğŸ¶",
    "ğŸ¼",
    "ğŸŒ",
    "ğŸ‘¥",
];
var city0 = "è–©æ ¼çˆ¾å¸‚";
var isp0 = "ç¿’ç¶­å°¼çš„ä¸­å—æµ·ç§äººISP";
var org0 = "ç¿’åŒªç¦è©•å§å¤«çš„å·´æ‹¿é¦¬å…¬å¸"

function getRandomInt(max) {
    return Math.floor(Math.random() * Math.floor(max));
}

function City_ValidCheck(para, regionName, city) {
    if (regionName === "Taiwan") {
        return city;
    } else if (para) {
        return para;
    } else {
        return city0;
        // emojis[getRandomInt(emojis.length)]
    }
}

function ISP_ValidCheck(para) {
    if (para) {
        return para;
    } else {
        return isp0;
        //emojis[getRandomInt(emojis.length)]
    }
}

function ORG_ValidCheck(para) {
    if (para) {
        return para;
    } else {
        return org0;
        //emojis[getRandomInt(emojis.length)]
    }
}

//version: 1.0
//no-sullah-bandits
//except: äºå¡æ‹œç„¶å…±å’Œåœ‹ğŸ‡¦ğŸ‡¿ é˜¿çˆ¾å·´å°¼äºå…±å’Œåœ‹ğŸ‡¦ğŸ‡± ç§‘ç´¢æ²ƒå…±å’Œåœ‹ğŸ‡½ğŸ‡° å—è˜‡ä¸¹å…±å’Œåœ‹ğŸ‡¸ğŸ‡©
//no-communist-bandits
var flags = new Map([
    ["AC", "ğŸ‡¦ğŸ‡¨"],
    ["AE", "ğŸ–7ï¸âƒ£"],
    ["AF", "ğŸ–ğŸ’€"],
    ["AI", "ğŸ‡¦ğŸ‡®"],
    ["AL", "ğŸ‡¦ğŸ‡±"],
    ["AQ", "ğŸ‡¦ğŸ‡¶"],
    ["AR", "ğŸ‡¦ğŸ‡·"],
    ["AS", "ğŸ‡¦ğŸ‡¸"],
    ["AT", "ğŸ‡¦ğŸ‡¹"],
    ["AU", "ğŸ‡¦ğŸ‡º"],
    ["AW", "ğŸ‡¦ğŸ‡¼"],
    ["AX", "ğŸ‡¦ğŸ‡½"],
    ["AZ", "ğŸ‡¦ğŸ‡¿"],
    ["BA", "ğŸ‡§ğŸ‡¦"],
    ["BB", "ğŸ‡§ğŸ‡§"],
    ["BD", "ğŸ–"],
    ["BE", "ğŸ‡§ğŸ‡ª"],
    ["BF", "ğŸ‡§ğŸ‡«"],
    ["BG", "ğŸ‡§ğŸ‡¬"],
    ["BH", "ğŸ–"],
    ["BI", "ğŸ‡§ğŸ‡®"],
    ["BJ", "ğŸ‡§ğŸ‡¯"],
    ["BM", "ğŸ‡§ğŸ‡²"],
    ["BN", "ğŸ–"],
    ["BO", "ğŸ‡§ğŸ‡´"],
    ["BR", "ğŸ‡§ğŸ‡·"],
    ["BS", "ğŸ‡§ğŸ‡¸"],
    ["BT", "ğŸ‡§ğŸ‡¹"],
    ["BV", "ğŸ‡§ğŸ‡»"],
    ["BW", "ğŸ‡§ğŸ‡¼"],
    ["BY", "âšªï¸ğŸ”´âšªï¸"],
    ["BZ", "ğŸ‡§ğŸ‡¿"],
    ["CA", "ğŸ‡¨ğŸ‡¦"],
    ["CF", "ğŸ‡¨ğŸ‡«"],
    ["CH", "ğŸ‡¨ğŸ‡­"],
    ["CK", "ğŸ‡¨ğŸ‡°"],
    ["CL", "ğŸ‡¨ğŸ‡±"],
    ["CM", "ğŸ‡¨ğŸ‡²"],
    ["CN", "ğŸ’©ğŸ•·ï¸"],
    ["CO", "ğŸ‡¨ğŸ‡´"],
    ["CP", "ğŸ‡¨ğŸ‡µ"],
    ["CR", "ğŸ‡¨ğŸ‡·"],
    ["CU", "ğŸ’©ğŸš¬"],
    ["CV", "ğŸ‡¨ğŸ‡»"],
    ["CW", "ğŸ‡¨ğŸ‡¼"],
    ["CX", "ğŸ‡¨ğŸ‡½"],
    ["CY", "ğŸ‡¨ğŸ‡¾"],
    ["CZ", "ğŸ‡¨ğŸ‡¿"],
    ["DE", "ğŸ‡©ğŸ‡ª"],
    ["DG", "ğŸ‡©ğŸ‡¬"],
    ["DJ", "ğŸ‡©ğŸ‡¯"],
    ["DK", "ğŸ‡©ğŸ‡°"],
    ["DM", "ğŸ‡©ğŸ‡²"],
    ["DO", "ğŸ‡©ğŸ‡´"],
    ["DZ", "ğŸ–"],
    ["EA", "ğŸ‡ªğŸ‡¦"],
    ["EC", "ğŸ‡ªğŸ‡¨"],
    ["EE", "ğŸ‡ªğŸ‡ª"],
    ["EG", "ğŸ–"],
    ["EH", "ğŸ–"],
    ["ER", "ğŸ–"],
    ["ES", "ğŸ‡ªğŸ‡¸"],
    ["ET", "ğŸ‡ªğŸ‡¹"],
    ["EU", "ğŸ‡ªğŸ‡º"],
    ["FI", "ğŸ‡«ğŸ‡®"],
    ["FJ", "ğŸ‡«ğŸ‡¯"],
    ["FK", "ğŸ‡«ğŸ‡°"],
    ["FM", "ğŸ‡«ğŸ‡²"],
    ["FO", "ğŸ‡«ğŸ‡´"],
    ["FR", "ğŸ‡«ğŸ‡·"],
    ["GA", "ğŸ‡¬ğŸ‡¦"],
    ["GB", "ğŸ‡¬ğŸ‡§"],
    ["HK", "ğŸ´"],
    ["HU", "ğŸ‡­ğŸ‡º"],
    ["ID", "ğŸ–ğŸ’"],
    ["IE", "ğŸ‡®ğŸ‡ª"],
    ["IL", "ğŸ‡®ğŸ‡±"],
    ["IM", "ğŸ‡®ğŸ‡²"],
    ["IN", "ğŸ‡®ğŸ‡³"],
    ["IS", "ğŸ‡®ğŸ‡¸"],
    ["IT", "ğŸ‡®ğŸ‡¹"],
    ["JP", "ğŸ‡¯ğŸ‡µ"],
    ["KR", "ğŸ‡°ğŸ‡·"],
    ["LU", "ğŸ‡±ğŸ‡º"],
    ["MO", "ğŸ°"],
    ["MX", "ğŸ‡²ğŸ‡½"],
    ["MY", "ğŸ–ğŸ"],
    ["NL", "ğŸ‡³ğŸ‡±"],
    ["PH", "ğŸ‡µğŸ‡­"],
    ["RO", "ğŸ‡·ğŸ‡´"],
    ["RS", "ğŸ‡·ğŸ‡¸"],
    ["RU", "ğŸ’©ğŸ³ï¸ğŸ–•"],
    ["RW", "ğŸ‡·ğŸ‡¼"],
    ["SA", "ğŸ–"],
    ["SB", "ğŸ‡¸ğŸ‡§"],
    ["SC", "ğŸ‡¸ğŸ‡¨"],
    ["SD", "ğŸ–"],
    ["SE", "ğŸ‡¸ğŸ‡ª"],
    ["SG", "ğŸ–ğŸŒ"],
    ["TH", "ğŸ‡¹ğŸ‡­"],
    ["TN", "ğŸ–"],
    ["TO", "ğŸ‡¹ğŸ‡´"],
    ["TR", "ğŸ–ğŸ¦ƒ"],
    ["TV", "ğŸ‡¹ğŸ‡»"],
    ["TW", "ğŸ‡¹ğŸ‡¼"],
    ["UK", "ğŸ‡¬ğŸ‡§"],
    ["UM", "ğŸ‡ºğŸ‡²"],
    ["US", "ğŸ‡ºğŸ‡¸"],
    ["UY", "ğŸ‡ºğŸ‡¾"],
    ["UZ", "ğŸ‡ºğŸ‡¿"],
    ["VA", "ğŸ‡»ğŸ‡¦"],
    ["VE", "ğŸ’©ğŸšŒ"],
    ["VG", "ğŸ‡»ğŸ‡¬"],
    ["VI", "ğŸ‡»ğŸ‡®"],
    ["VN", "ğŸŸ¡ğŸ”´ğŸŸ¡"],
    ["ZA", "âš«ï¸"],
    ["UA", "ğŸ‡ºğŸ‡¦"],
    ["MD", "ğŸ‡²ğŸ‡©"],
    ["AD", "ğŸ‡¦ğŸ‡©"],
    ["AM", "ğŸ‡¦ğŸ‡²"],
    ["AO", "ğŸ‡¦ğŸ‡´"],
    ["KP", "ğŸ–*ï¸âƒ£3ï¸âƒ£"],
    ["KY", "ğŸ‡°ğŸ‡¾"],
    ["KZ", "ğŸ‡°ğŸ‡¿"],
    ["NZ", "ğŸ‡³ğŸ‡¿"],
    ["PK", "ğŸ–"],
    ["NO", "ğŸ‡³ğŸ‡´"],
    ["PT", "ğŸ‡µğŸ‡¹"],
    ["PL", "ğŸ‡µğŸ‡±"],
    ["GR", "ğŸ‡¬ğŸ‡·"],
    ["NG", "ğŸ‡³ğŸ‡¬"],
    ["MV", "ğŸ–"],
    ["KH", "ğŸ‡°ğŸ‡­"],
    ["LA", "ğŸ’©"],
    ["GU", "ğŸ‡¬ğŸ‡º"],
    ["MN", "ğŸ‡²ğŸ‡³"],
    ["JO", "ğŸ–"],
    ["IR", "ğŸ¦"],
    ["OM", "ğŸ‡´ğŸ‡²"],
    ["PS", "ğŸ–ğŸ¸ğŸ’©"],
    ["NP", "ğŸ‡³ğŸ‡µ"],
    ["LB", "ğŸ–"],
    ["IQ", "ğŸ–"],
    ["SY", "ğŸ–"],
    ["QA", "ğŸ–â˜ ï¸"],
    ["GE", "ğŸ‡¬ğŸ‡ª"],
    ["LK", "ğŸ‡±ğŸ‡°"],
    ["KG", "ğŸ‡°ğŸ‡¬"],
    ["ME", "ğŸ‡²ğŸ‡ª"],
    ["LT", "ğŸ‡±ğŸ‡¹"],
    ["MT", "ğŸ‡²ğŸ‡¹"],
    ["MC", "ğŸ‡²ğŸ‡¨"],
    ["HR", "ğŸ‡­ğŸ‡·"],
    ["MK", "ğŸ‡²ğŸ‡°"],
    ["LV", "ğŸ‡±ğŸ‡»"],
    ["SK", "ğŸ‡¸ğŸ‡°"],
    ["GI", "ğŸ‡¬ğŸ‡®"],
    ["SM", "ğŸ‡¸ğŸ‡²"],
    ["LI", "ğŸ‡±ğŸ‡®"],
    ["RE", "ğŸ‡·ğŸ‡ª"],
    ["PA", "ğŸ‡µğŸ‡¦"],
    ["GL", "ğŸ‡¬ğŸ‡±"],
    ["PE", "ğŸ‡µğŸ‡ª"],
    ["PY", "ğŸ‡µğŸ‡¾"],
    ["JM", "ğŸ‡¯ğŸ‡²"],
    ["SR", "ğŸ‡¸ğŸ‡·"],
    ["GT", "ğŸ‡¬ğŸ‡¹"],
    ["PR", "ğŸ‡µğŸ‡·"],
    ["HN", "ğŸ‡­ğŸ‡³"],
    ["NI", "ğŸ‡³ğŸ‡®"],
    ["GH", "ğŸ‡¬ğŸ‡­"],
    ["MA", "ğŸ–"],
    ["LY", "ğŸ–ğŸŸ©"],
    ["KE", "ğŸ‡°ğŸ‡ª"],
    ["MU", "ğŸ‡²ğŸ‡º"],
    ["TL", "ğŸ‡¹ğŸ‡±"],
    ["SI", "ğŸ‡¸ğŸ‡®"],
    ["GF", "ğŸ‡¬ğŸ‡«"],
    ["TG", "ğŸ‡¹ğŸ‡¬"],
    ["XK", "ğŸ‡½ğŸ‡°"],
]);

var body = $response.body;
var obj = JSON.parse(body);
if (obj.timezone && obj.timezone.includes("Kiev")) {
    obj.timezone = obj.timezone.replace("Kiev", "Kyiv");
} //Glory to UkraineğŸ‡ºğŸ‡¦
var city = City_ValidCheck(obj['city'], obj['regionName'], obj['city']);//è§£æ±ºapiå°‡æ–°åŒ—å¸‚ç­‰åŸå¸‚regionNameè¿”å›ç‚ºTaiwanå•é¡Œ
var title = flags.get(obj["countryCode"]) + " " + City_ValidCheck(obj["city"]); //+Area_check(obj['country']);
var subtitle = ISP_ValidCheck(obj["org"] || obj.as);
var ip = obj["query"];
var description = "åœ‹å®¶:" + obj["isp"] + "\n" + "åœ°å€:" + City_ValidCheck(obj["regionName"]) + "\n" + "åŸå¸‚:" + obj["city"] + "\n" + "æ™‚å€" + obj["timezone"] + "\n" + "ğŸŒ" + "\n" + "IPåœ°å€" + obj["query"] + "\n" + "ä¾›æ‡‰å•†" + ISP_ValidCheck(obj["isp"]) + "\n" + "è³‡æ–™ä¸­å¿ƒ" + ORG_ValidCheck(obj["org"]);
$done({
    title,
    subtitle,
    ip,
    description
});